"use strict";function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}}var _getPrototypeOf=require("babel-runtime/core-js/object/get-prototype-of"),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=require("babel-runtime/helpers/classCallCheck"),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require("babel-runtime/helpers/createClass"),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=require("babel-runtime/helpers/possibleConstructorReturn"),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=require("babel-runtime/helpers/inherits"),_inherits3=_interopRequireDefault(_inherits2),Base=require("orion-core/lib/Base"),xfs=require("orion-core/lib/xfs"),url=require("url"),path=require("path"),keytar=process.argv.indexOf("--sandbox")===-1&&require("keytar"),Util=require("orion-core/lib/Util"),logger=require("orion-core/lib/Logger").getInstance().forClass("auth/Native"),Native=function(a){function b(a){(0,_classCallCheck3["default"])(this,b);var c=(0,_possibleConstructorReturn3["default"])(this,(b.__proto__||(0,_getPrototypeOf2["default"])(b)).call(this));return Util.merge(c,a),c._errors=[],c._baseKey="ST_AUTH_",c}return(0,_inherits3["default"])(b,a),(0,_createClass3["default"])(b,[{key:"add",value:function(){return logger.trace(".add"),this._validate(),keytar.addPassword(this.storageKey,this.username,this.password)}},{key:"delete",value:function(){return logger.trace(".delete"),this._validate(!0),keytar.deletePassword(this.storageKey,this.username)}},{key:"exists",value:function(){return logger.trace(".exists"),!!this.get()}},{key:"get",value:function(){return logger.trace(".get"),keytar.getPassword(this.storageKey,this.username,this.password)}},{key:"replace",value:function(){return logger.trace(".replace"),this._validate(),keytar.replacePassword(this.storageKey,this.username,this.password)}},{key:"_formatKey",value:function(){return logger.trace("._formatKey"),this.baseKey+this.key}},{key:"_validate",value:function(a){logger.trace("._validate");var b=this,c=b._errors;Util.isString(b.key)||c.push("A key is required!"),Util.isString(b.username)||c.push("A username is required!"),a||Util.isString(b.password)||c.push("A password is required!"),c.length&&c.forEach(function(a){logger.error(a)})}},{key:"baseKey",get:function(){return"ST_AUTH_"}},{key:"storageKey",get:function(){return this._formatKey()}}]),b}(Base);module.exports=Native;