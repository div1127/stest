"use strict";

const JIRA = require('orion-core/lib/auth/JIRA');

var toHex = function (str) {
    let hex = '',
        i;

    for (i=0; i<str.length; i++) {
        hex += str.charCodeAt(i).toString(16);
    }

    return hex;
}

describe('JIRA', function () {
    var auth, creds = {
        key: 'Bucket',
        username: 'testy.mctesterton',
        password: 'P@s$wOrd!'
    };

    afterEach(function () {
        auth.delete();
        auth = null;
    });

    describe('storageKey', function () {
        it('should return a concatentation of the base key plus user-provided key', function () {
            auth = new JIRA(creds);
            auth.add();

            expect(auth.storageKey).toBe('ST_AUTH_JIRA_' + toHex(creds.key));
        });
    });
});
